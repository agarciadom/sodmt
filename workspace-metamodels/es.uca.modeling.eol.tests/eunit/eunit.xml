<project name="es.uca.modeling.eol.tests" default="allTests">

	<property name="models.dir" location="models"/>
	<property name="metamodel.uri" value="www.uca.es/modeling/serviceProcess"/>

	<!-- BASIC TARGETS -->

	<target name="init" description="Prepares the testing environment">
		<delete dir="${basedir}" includes="TEST*.xml" />
		<tstamp />
	    <macrodef name="loadModel">
	    <attribute name="name" />
        	<sequential>
	      		<epsilon.emf.loadModel name="@{name}"
	      			modelfile="${models.dir}/@{name}.model"
					metamodeluri="${metamodel.uri}"
      				read="true" store="false" />
        	</sequential>
    	</macrodef>
	</target>

	<target name="allTests" depends="tlimits,caggregation" description="Runs all tests">
		<junitreport>
			<fileset dir="${basedir}" includes="TEST-*.xml" />
			<report format="noframes" todir="report" />
		</junitreport>
	</target>

	<!-- TEST TARGETS -->

	<target name="tlimits" description="Tests for the inferred time limits" depends="init">
		<epsilon.eunit src="tlimits.eunit" package="sodmt.adhoc.eol">
			<modelTasks>
				<loadModel name="dense"/>
				<loadModel name="handleOrder"/>
				<loadModel name="minimal"/>
				<loadModel name="sequence-w_auto_constraint"/>
				<loadModel name="sequence"/>
				<loadModel name="single-dipole"/>
				<loadModel name="single-node"/>
				<loadModel name="two-dipoles-Aneeds40"/>
				<loadModel name="two-dipoles"/>
			</modelTasks>
		</epsilon.eunit>
	</target>

	<target name="caggregation" description="Tests for the aggregated constraints" depends="init">
		<epsilon.eunit src="caggregation.eunit" package="sodmt.adhoc.eol">
			<modelTasks>
				<loadModel name="minimal"/>
				<loadModel name="sequence"/>
				<loadModel name="single-dipole"/>
				<loadModel name="two-dipoles"/>
			</modelTasks>
		</epsilon.eunit>
	</target>
</project>
